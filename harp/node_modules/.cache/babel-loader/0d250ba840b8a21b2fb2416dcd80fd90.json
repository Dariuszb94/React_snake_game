{"ast":null,"code":"var _jsxFileName = \"E:\\\\Kodowanie\\\\Snake_game\\\\src\\\\Game.js\";\nimport React, { Component } from 'react';\nimport Cells from './Cells';\nimport { START, BODY, FOOD, KEYS, COLS, ROWS, DIRS } from './const';\nimport './style.css';\n\nclass Game extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleKey = event => {\n      const direction = event.nativeEvent.keyCode;\n      const diff = Math.abs(this.props.direction - direction);\n\n      if (DIRS[direction] && diff !== 0 && diff !== 2) {\n        this.nextDirecion = direction;\n      }\n    };\n\n    this.state = {\n      board: [],\n      snake: [],\n      direction: null,\n      gameOver: false\n    };\n    this.start = this.start.bind(this);\n    this.frame = this.frame.bind(this);\n    this.handleKey = this.handleKey.bind(this);\n  }\n\n  componentDidMount() {\n    this.start();\n  }\n\n  start() {\n    const board = [];\n    const snake = [START];\n    board[START] = BODY;\n    this.setState({\n      board,\n      snake,\n      direction: KEYS.down\n    }, () => {\n      this.frame();\n    });\n  }\n\n  frame() {\n    let _this$state = this.state,\n        snake = _this$state.snake,\n        board = _this$state.board,\n        direction = _this$state.direction;\n    const head = this.getNextIndex(snake[0], direction);\n    const food = board[head] === FOOD || snake.length === 1;\n\n    if (food) {\n      const maxCells = ROWS * COLS;\n      let i;\n\n      do {\n        i = Math.floor(Math.random() * maxCells);\n      } while (board[i]);\n\n      board[i] = FOOD;\n    } else {\n      board[snake.pop()] = null;\n    }\n\n    board[head] = BODY;\n    snake.unshift(head);\n\n    if (this.nextDirecion) {\n      direction = this.nextDirecion;\n      this.nextDirecion = null;\n    }\n\n    this.setState({\n      board,\n      snake,\n      direction\n    }, () => {\n      setTimeout(this.frame, 200);\n    });\n  }\n\n  getNextIndex(head, direction) {\n    let x = head % COLS;\n    let y = Math.floor(head / COLS);\n\n    switch (direction) {\n      case KEYS.up:\n        y = y <= 0 ? ROWS - 1 : y - 1;\n        break;\n\n      case KEYS.down:\n        y = y >= ROWS ? 0 : y + 1;\n        break;\n\n      case KEYS.left:\n        x = x <= 0 ? COLS - 1 : x - 1;\n        break;\n\n      case KEYS.right:\n        x = x >= COLS - 1 ? 0 : x + 1;\n        break;\n\n      default:\n        return;\n    }\n\n    return COLS * y + x;\n  }\n\n  render() {\n    const board = this.state.board;\n    return React.createElement(Cells, {\n      handleKey: this.handleKey,\n      board: board,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    });\n  }\n\n}\n\nexport default Game;","map":{"version":3,"sources":["E:/Kodowanie/Snake_game/src/Game.js"],"names":["React","Component","Cells","START","BODY","FOOD","KEYS","COLS","ROWS","DIRS","Game","constructor","props","handleKey","event","direction","nativeEvent","keyCode","diff","Math","abs","nextDirecion","state","board","snake","gameOver","start","bind","frame","componentDidMount","setState","down","head","getNextIndex","food","length","maxCells","i","floor","random","pop","unshift","setTimeout","x","y","up","left","right","render"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport Cells from './Cells';\r\nimport {START, BODY, FOOD, KEYS, COLS, ROWS, DIRS} from './const';\r\nimport './style.css';\r\n\r\n\r\nclass Game extends Component {\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.state={\r\nboard:[],\r\nsnake:[],\r\ndirection:null,\r\ngameOver:false\r\n\t\t};\r\n\t\tthis.start=this.start.bind(this);\r\n\t\tthis.frame=this.frame.bind(this);\r\n\t\tthis.handleKey=this.handleKey.bind(this);\r\n\t}\r\ncomponentDidMount(){\r\n\tthis.start();\r\n}\r\n\r\n\tstart(){\r\nconst board=[];\r\nconst snake=[START];\r\nboard[START]=BODY;\r\n\r\nthis.setState({\r\n\tboard,\r\n\tsnake,\r\n\tdirection: KEYS.down\r\n},()=>{\r\n\tthis.frame();\r\n});\r\n\t}\r\n\r\n\tframe(){\r\nlet {snake, board, direction}=this.state;\r\nconst head=this.getNextIndex(snake[0],direction);\r\n\r\nconst food=board[head]===FOOD || snake.length === 1; \r\n\r\nif (food){\r\n\tconst maxCells=ROWS * COLS; \r\n\tlet i;\r\n\r\n\tdo{\r\ni=Math.floor(Math.random()*maxCells)\r\n\t}\r\n\twhile(board[i])\r\n\t\tboard[i]=FOOD;\r\n}else{\r\n\tboard[snake.pop()]=null;\r\n}\r\n\r\nboard[head]=BODY;\r\nsnake.unshift(head);\r\n\r\nif(this.nextDirecion){\r\n\tdirection=this.nextDirecion;\r\n\tthis.nextDirecion=null;\r\n}\r\n\r\nthis.setState({\r\n\tboard,\r\n\tsnake,\r\n\tdirection\r\n},()=>{\r\n\tsetTimeout(this.frame, 200)\r\n})\r\n\t}\r\n\r\nhandleKey = (event)=>{\r\n\r\n\tconst direction=event.nativeEvent.keyCode;\r\n\r\nconst diff=Math.abs(this.props.direction-direction);\r\nif(DIRS[direction] && diff !== 0 && diff !== 2){\r\n\tthis.nextDirecion=direction;\r\n\r\n}\r\n}\r\n\r\n\r\n\r\n\tgetNextIndex(head, direction){\r\n\t\tlet x=head%COLS;\r\n\t\tlet y=Math.floor(head/COLS);\r\n\r\nswitch(direction){\r\n\tcase KEYS.up: y = y<=0 ? ROWS-1: y-1; break;\r\n\r\n\tcase KEYS.down: y = y>= ROWS ? 0 : y+1; break;\r\n\r\n\tcase KEYS.left: x = x<=0 ? COLS-1 : x-1; break;\r\n\r\n\tcase KEYS.right: x = x>=COLS-1 ? 0 : x+1; break;\r\n\r\n\tdefault: return;\r\n}\r\nreturn (COLS*y)+x;\r\n\t}\r\n\trender(){\r\n\t\tconst {board}=this.state;\r\nreturn (\r\n\t<Cells \r\n\thandleKey={this.handleKey}\r\n\tboard={board}\r\n\t/>\r\n\t)\r\n\t}\r\n}\r\nexport default Game;"]},"metadata":{},"sourceType":"module"}